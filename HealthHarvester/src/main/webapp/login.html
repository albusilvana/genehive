<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Health Harvester- Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- The styles -->
    <link id="bs-css" href="css/bootstrap-cerulean.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-bottom: 40px;
        }

        .sidebar-nav {
            padding: 9px 0;
        }
    </style>
    <link href="css/bootstrap-responsive.css" rel="stylesheet">
    <link href="css/charisma-app.css" rel="stylesheet">
    <link href="css/jquery-ui-1.8.21.custom.css" rel="stylesheet">
    <link href="css/fullcalendar.css" rel="stylesheet">
    <link href="css/fullcalendar.print.css" rel="stylesheet" media="print">
    <link href="css/chosen.css" rel="stylesheet">
    <link href="css/uniform.default.css" rel="stylesheet">
    <link href="css/colorbox.css" rel="stylesheet">
    <link href="css/jquery.cleditor.css" rel="stylesheet">
    <link href="css/jquery.noty.css" rel="stylesheet">
    <link href="css/noty_theme_default.css" rel="stylesheet">
    <link href="css/elfinder.min.css" rel="stylesheet">
    <link href="css/elfinder.theme.css" rel="stylesheet">
    <link href="css/font-awesome/css/font-awesome.min.css" rel="stylesheet"/>
    <script src="js/lib/jquery/jquery-min.js"></script>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/fancybox/jquery.fancybox.css" rel="stylesheet">
    <!--<link href="css/jcarousel.css" rel="stylesheet"/>-->
    <link href="css/flexslider.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>

    <!-- Theme skin -->
    <link href="skins/default.css" rel="stylesheet"/>
    <script type="text/javascript">
        $(document).ready(function () {
            if(localStorage.getItem("errorMessage")){
                document.getElementById("errors").innerHTML=localStorage.getItem("errorMessage");
                document.getElementById("errors").style.display = "block";
            }
        });
        function submitLogin(){
            $.ajax({
                url: "http://localhost:9095/hh/API/v1/authenticate/withCredentials?username="+$("#username").val()+"&password="+$("#password").val(),
                context: document.body
            }).done(function(resp) {
                if(resp != ""){
                    localStorage.setItem("isUserLoggedIn", true);
                    localStorage.setItem("token", resp);
                    window.location = "http://localhost:9095/hh/statistics.html";
                }
                else{
                    document.getElementById("errors").innerHTML="The username or password is incorrect. Please try again.";
                    document.getElementById("errors").style.display = "block";
                }
            });


        }
    </script>
</head>

<body>
<div class="container-fluid">
    <div class="row-fluid">
        <div class="row-fluid">
            <header>
                <div class="navbar navbar-default navbar-static-top">
                    <div class="container">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse"
                                    data-target=".navbar-collapse">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a class="navbar-brand" href="index.html"><span>H</span>ealth<span> H</span>arvester</a>
                        </div>
                    </div>
                </div>
            </header>
        </div>
    </div>
    <div class="row-fluid">
        <div class="well span5 center login-box">
            <div class="alert alert-info">
                Please log in with your Username and Password.
            </div>
            <div id="errors" class="alert alert-danger" style="display:none"></div>
            <div id="loginForm" class="form-horizontal">
                <fieldset>
                    <div class="input-prepend" title="Username" data-rel="tooltip">
                                    <span class="add-on" style="display: inline">
                                        <label for="username"><i class="fa fa-user fa-fw"></i></label>
                                    </span>
                        <input autofocus class="input-large span9" name="j_username" id="username" type="text" value=""
                               placeholder="Username"/>
                    </div>
                    <div class="clearfix"></div>
                    <div class="input-prepend" title="Password" data-rel="tooltip">
                                <span class="add-on" style="display: inline">
                                    <label for="password"><i class="fa fa-key fa-fw"></i></label>
                                </span>
                        <input class="input-large span9" name="j_password" id="password" type="password" value=""
                               placeholder="Password"/>
                    </div>
                    <div class="clearfix"></div>

                    <div class="clearfix"></div>
                    <p class="center span5">
                        <button type="submit" onclick="submitLogin()" id="loginSubmit" class="btn btn-primary">Log in</button>
                    </p>
                </fieldset>
            </div>
        </div>
    </div>
</div>
</div>
</body>
</html>